#!/usr/bin/env bash

function main {
  local shome="${_limbo_home:-"$(cd -P -- "$(dirname -- "$BASH_SOURCE")/.." && pwd -P)"}"
  source "$shome/script/profile"

  set -x
  rm -rf "$LXD_CONF"
  mkdir -p "$LXD_CONF"
  lxc remote remove "$BASEBOX_INSTANCE" 2>/dev/null || true
  echo y | lxc remote add "$BASEBOX_INSTANCE" "$BASEBOX_IP" --password=ubuntu
  lxc remote set-default "$BASEBOX_INSTANCE" 

	lxc profile create limbo || true
	lxc profile set limbo user.user-data - < "$BLOCK_PATH/limbo/cidata/user-data"

	lxc info
	lxc list
}

source sub "$BASH_SOURCE" "$@"
